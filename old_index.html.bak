<!DOCTYPE html>
<html lang="zh-CN"> <!-- å¢åŠ è¯­è¨€å±æ€§ -->
<head>
    <title>ARKè±†åŒ…ç¿»è¯‘å™¨ - æš—é»‘æ¨¡å¼</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    
    <!-- 1. polyfill.min.js æ˜¯å¯é€‰çš„ï¼Œä¸»è¦ç”¨äºå…¼å®¹æ—§ç‰ˆæµè§ˆå™¨ï¼Œå¯ä»¥ä¿ç•™ -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6" defer></script>
    
    <!-- âœ¨ ä¿®æ”¹ç‚¹ 1: å°† marked.js çš„ CDN é“¾æ¥æ›¿æ¢ä¸ºæœ¬åœ°é“¾æ¥ -->
    <script src="{{ url_for('static', filename='lib/marked.min.js') }}" defer></script>
    
    <!-- 2. MathJax çš„é…ç½®éƒ¨åˆ†ä¿æŒä¸å˜ -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true,
                packages: {'[+]': ['ams']}
            },
            options: {
                ignoreHtmlClass: 'tex2jax_ignore',
                processHtmlClass: 'tex2jax_process',
                // å¢åŠ è¿™ä¸ªé€‰é¡¹å¯ä»¥æå‡é¦–æ¬¡æ¸²æŸ“é€Ÿåº¦
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
            },
            // æå‡åŠ è½½é€Ÿåº¦
            loader: {load: ['[tex]/ams']}
        };
    </script>
    
    <!-- âœ¨ ä¿®æ”¹ç‚¹ 2: å°† MathJax.js çš„ CDN é“¾æ¥æ›¿æ¢ä¸ºæœ¬åœ°é“¾æ¥ -->
    <script id="MathJax-script" async
            src="{{ url_for('static', filename='lib/tex-mml-chtml.js') }}">
    </script>
</head>
<body>
    <div class="container">
        
        <div class="translation-area">
            <div class="input-section" id="inputSection">
                <div class="section-header">
                    <div class="language-selector">
                        <span class="lang-label">æºè¯­è¨€:</span>
                        <select id="sourceLang">
                            <option value="auto">è‡ªåŠ¨æ£€æµ‹</option>
                            {% for lang_name, lang_code in languages.items() %}
                            <option value="{{ lang_code }}">{{ lang_name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <button type="button" id="swapBtn" class="swap-btn" title="äº¤æ¢è¯­è¨€">â‡„</button>
                </div>
                <textarea 
                    id="textInput" 
                    class="text-area" 
                    placeholder="è¯·è¾“å…¥è¦ç¿»è¯‘çš„æ–‡æœ¬...&#10;&#10;æç¤ºï¼šè¾“å…¥æ–‡æœ¬åä¼šè‡ªåŠ¨ç¿»è¯‘ï¼Œæ— éœ€ç‚¹å‡»æŒ‰é’®&#10;æ”¯æŒLaTeXæ•°å­¦å…¬å¼ï¼š$...$ è¡Œå†…å…¬å¼ï¼Œ$$...$$ å—çº§å…¬å¼"
                    autofocus
                ></textarea>
                <div class="input-footer">
                    <div class="char-count">
                        <span id="charCount">0</span> å­—ç¬¦
                    </div>
                    <button type="button" id="clearBtn" class="clear-btn">æ¸…ç©º</button>
                </div>
            </div>
            
            <button type="button" id="collapseBtn" class="collapse-btn" title="æŠ˜å /å±•å¼€è¾“å…¥æ¡†">Â«</button>
            
            <div class="output-section" id="outputSection">
                <div class="section-header">
                    <div class="language-selector">
                        <span class="lang-label">ç›®æ ‡è¯­è¨€:</span>
                        <select id="targetLang">
                            {% for lang_name, lang_code in languages.items() %}
                            <option value="{{ lang_code }}" {% if lang_code == 'zh' %}selected{% endif %}>{{ lang_name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <button type="button" id="copyBtn" class="copy-btn icon-btn" title="å¤åˆ¶ç¿»è¯‘ç»“æœ" aria-live="polite">
                        <span id="copyIcon" aria-hidden="true">ğŸ“‹</span>
                        <span class="sr-only">å¤åˆ¶ç¿»è¯‘ç»“æœ</span>
                    </button>
                </div>
                <div id="outputText" class="output-text">
                    ç¿»è¯‘ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...
                </div>
            </div>
        </div>
        
        <div id="loading" class="loading">
            <div class="loading-spinner"></div>
            <div>ç¿»è¯‘ä¸­...</div>
        </div>

        <section class="history-section">
            <details class="history-details" id="historyDetails">
                <summary>å†å²è®°å½•</summary>
                <div id="historyList" class="history-list empty">
                    <p class="history-empty">æš‚æ— å†å²è®°å½•</p>
                </div>
            </details>
        </section>

        <div class="status-bar">
            <div class="auto-translate">
                <label>
                    <span>è‡ªåŠ¨ç¿»è¯‘</span>
                    <div class="switch">
                        <input type="checkbox" id="autoTranslate" checked>
                        <span class="slider"></span>
                    </div>
                </label>
            </div>
            <div class="font-size-control">
                <label for="fontSizeSlider">å­—ä½“å¤§å°</label>
                <input type="range" id="fontSizeSlider" min="12" max="26" step="1" value="16">
                <span id="fontSizeValue" class="font-size-value">16px</span>
            </div>
            <div id="statusMessage">å‡†å¤‡å°±ç»ª</div>
        </div>
    </div>
    
    <!-- æ‚¨çš„ä¸»è„šæœ¬æ–‡ä»¶å¼•ç”¨ä¿æŒä¸å˜ -->
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>